---
description: Component
slug: /ee17c27
tags: 
  - Component
---


import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

## å‰è¨€

#### æœ¬ç« å°†å­¦ä¹ åˆ°çš„å†…å®¹

- `React`ç»„ä»¶çš„æœ¬è´¨
- ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶çš„åŒºåˆ«
- ç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼
- ç»„ä»¶çš„å¼ºåŒ–/æ‰©å±•æ–¹å¼


## Reactç»„ä»¶çš„æœ¬è´¨
ğŸ‘‰ ç»„ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ç±»å’Œå‡½æ•°ï¼Œä½†æ˜¯ä¸å¸¸è§„çš„ç±»å’Œå‡½æ•°ä¸åŒçš„æ˜¯ï¼Œ***ç»„ä»¶æ‰¿è½½äº†æ¸²æŸ“è§†å›¾çš„ UI å’Œæ›´æ–°è§†å›¾çš„ setState ã€ useState ç­‰æ–¹æ³•***

ğŸ‘‰ `React` ç»„ä»¶ä¸ŠåŒæ ·å…·æœ‰å‡½æ•°ä¸ç±»çš„ç‰¹æ€§ï¼Œæ¯”å¦‚åŸå‹é“¾ï¼Œç»§æ‰¿ï¼Œé™æ€å±æ€§ç­‰


```jsx
/* ç±» */
class textClass {
    sayHello=()=>console.log('hello, my name is alien')
}
/* ç±»ç»„ä»¶ */
class Index extends React.Component {
    state={ message:`hello ï¼Œworld!` }
    sayHello=()=> this.setState({ message : 'hello, my name is alien' })
    render(){
        return <div onClick={ this.sayHello }> { this.state.message }  </div>
    }
}

/* å‡½æ•° */
function textFun () { 
    return 'hello, world'
}
/* å‡½æ•°ç»„ä»¶ */
function FunComponent(){
    const [ message , setMessage ] = useState('hello,world')
    return <div onClick={ ()=> setMessage('hello, my name is alien')  } >{ message }</div>
}
```

## ç±»ç»„ä»¶ä¸å‡½æ•°ç»„ä»¶

#### æºç 

<Tabs>
<TabItem value="class" label="ç±»ç»„ä»¶">

```js title=react-reconciler/src/ReactFiberClassComponent.js
function constructClassInstance(
    workInProgress, // å½“å‰æ­£åœ¨å·¥ä½œçš„ fiber å¯¹è±¡
    ctor,           // æˆ‘ä»¬çš„ç±»ç»„ä»¶
    props           // props 
){
    /* ğŸ‘‰ å®ä¾‹åŒ–ç»„ä»¶ï¼Œå¾—åˆ°ç»„ä»¶å®ä¾‹ instance */
    const instance = new ctor(props, context)
}
```

</TabItem>
<TabItem value="function" label="å‡½æ•°ç»„ä»¶">

```js title=react-reconciler/src/ReactFiberHooks.js
function renderWithHooks(
  current,          // å½“å‰å‡½æ•°ç»„ä»¶å¯¹åº”çš„ `fiber`ï¼Œ åˆå§‹åŒ–
  workInProgress,   // å½“å‰æ­£åœ¨å·¥ä½œçš„ fiber å¯¹è±¡
  Component,        // æˆ‘ä»¬å‡½æ•°ç»„ä»¶
  props,            // å‡½æ•°ç»„ä»¶ç¬¬ä¸€ä¸ªå‚æ•° props
  secondArg,        // å‡½æ•°ç»„ä»¶å…¶ä»–å‚æ•°
  nextRenderExpirationTime, //ä¸‹æ¬¡æ¸²æŸ“è¿‡æœŸæ—¶é—´
){
     /* ğŸ‘‰ ç›´æ¥æ‰§è¡Œå‡½æ•°ç»„ä»¶ï¼Œå¾—åˆ° return è¿”å›çš„ React.elementå¯¹è±¡ */
     let children = Component(props, secondArg);
}
```

</TabItem>
</Tabs>

### ç±»ç»„ä»¶

```js
  /* å®ä¾‹åŒ–ç»„ä»¶ï¼Œå¾—åˆ°ç»„ä»¶å®ä¾‹ instance */
  let instance = new ctor(props, context);
```

:::tip 

å¯¹äºç±»ç»„ä»¶æ¥è¯´ï¼Œåº•å±‚åªéœ€è¦ ***å®ä¾‹åŒ–ä¸€æ¬¡***ï¼Œå®ä¾‹ä¸­ä¿å­˜äº†ç»„ä»¶çš„ state ç­‰çŠ¶æ€ã€‚å¯¹äºæ¯ä¸€æ¬¡æ›´æ–°åªéœ€è¦è°ƒç”¨ render æ–¹æ³•ä»¥åŠå¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸå°±å¯ä»¥äº†

:::

#### React.Component çš„æºç 

```js title=react/src/ReactBaseClasses.js
function Component(props, context, updater) {
  this.props = props;      //ç»‘å®šprops
  this.context = context;  //ç»‘å®šcontext
  this.refs = emptyObject; //ç»‘å®šref
  this.updater = updater || ReactNoopUpdateQueue; //ä¸Šé¢æ‰€å±çš„updater å¯¹è±¡
}
/* ç»‘å®šsetState æ–¹æ³• */
Component.prototype.setState = function(partialState, callback) {
  this.updater.enqueueSetState(this, partialState, callback, 'setState');
}
/* ç»‘å®šforceupdate æ–¹æ³• */
Component.prototype.forceUpdate = function(callback) {
  this.updater.enqueueForceUpdate(this, callback, 'forceUpdate');
}
```

:::tip ç±»ç»„ä»¶æ‰§è¡Œæ„é€ å‡½æ•°è¿‡ç¨‹

1. åœ¨å®ä¾‹ä¸Šç»‘å®š props å’Œ context
2. åˆå§‹åŒ–ç½®ç©º refs å±æ€§
3. åŸå‹é“¾ä¸Šç»‘å®šsetStateã€forceUpdate æ–¹æ³•
4. å¯¹äº updaterï¼ŒReact åœ¨å®ä¾‹åŒ–ç±»ç»„ä»¶ä¹‹åä¼šå•ç‹¬ç»‘å®š update å¯¹è±¡

:::


### å‡½æ•°ç»„ä»¶

```js
  /* æ‰§è¡Œæˆ‘ä»¬çš„å‡½æ•°ç»„ä»¶ï¼Œå¾—åˆ° return è¿”å›çš„ React.elementå¯¹è±¡ */
  let children = Component(props, secondArg);
```

:::tip

åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œ ***æ¯ä¸€æ¬¡æ›´æ–°éƒ½æ˜¯ä¸€æ¬¡æ–°çš„å‡½æ•°æ‰§è¡Œ***ï¼Œä¸€æ¬¡å‡½æ•°ç»„ä»¶çš„æ›´æ–°ï¼Œé‡Œé¢çš„å˜é‡ä¼šé‡æ–°å£°æ˜

ğŸ‘‰ ä¸ºäº†è®©å‡½æ•°ç»„ä»¶å¯ä»¥ä¿å­˜ä¸€äº›çŠ¶æ€ï¼Œæ‰§è¡Œä¸€äº›å‰¯ä½œç”¨é’©å­ï¼Œ`React Hooks` åº”è¿è€Œç”Ÿ

:::


## ç»„ä»¶é—´çš„é€šä¿¡æ–¹å¼

ğŸ‘‰ React ä¸€å…±æœ‰ 5 ç§ä¸»æµçš„é€šä¿¡æ–¹å¼ï¼š

1. `props` å’Œ `callback` æ–¹å¼
2. `ref` æ–¹å¼
3. `React-redux` æˆ– `React-mobx` çŠ¶æ€ç®¡ç†æ–¹å¼
4. `context` ä¸Šä¸‹æ–‡æ–¹å¼
5. `event bus` äº‹ä»¶æ€»çº¿

### `props` å’Œ `callback` æ–¹å¼

```jsx title=å­ç»„ä»¶
function Son(props){
    const {  
      fatherSay, // çˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„å˜é‡props
      sayFather  // çˆ¶ç»„ä»¶ä¼ è¿‡æ¥çš„æ–¹æ³•props
    } = props
    return <div className='son' >
        æˆ‘æ˜¯å­ç»„ä»¶
        <div> çˆ¶ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{ fatherSay } </div>
        <input placeholder="æˆ‘å¯¹çˆ¶ç»„ä»¶è¯´" onChange={(e) => {
            sayFather(e.target.value)  // æ‰§è¡Œçˆ¶ç»„ä»¶çš„sayFatheræ–¹æ³•ï¼Œå¹¶ä¼ é€’å‚æ•°ï¼Œé€šçŸ¥çˆ¶ç»„ä»¶æ‰§è¡ŒsetChildSay
          }
        }   />
    </div>
}
```

```jsx title=çˆ¶ç»„ä»¶
function Father(){
    const [ childSay , setChildSay ] = useState('')
    const [ fatherSay , setFatherSay ] = useState('')
    return <div className="box father" >
        æˆ‘æ˜¯çˆ¶ç»„ä»¶
       <div> å­ç»„ä»¶å¯¹æˆ‘è¯´ï¼š{ childSay } </div>
       <input placeholder="æˆ‘å¯¹å­ç»„ä»¶è¯´" onChange={ (e)=>setFatherSay(e.target.value) }   />
       <Son 
          // é€šè¿‡è‡ªèº« state æ”¹å˜ï¼Œé‡æ–°æ¸²æŸ“ï¼Œä¼ é€’ props ç»™å­ç»„ä»¶
          fatherSay={fatherSay}  
          sayFather={ setChildSay }
       />
    </div>
}
```


## ç»„ä»¶çš„å¼ºåŒ–/æ‰©å±•æ–¹å¼

ğŸ‘‰ ç»„ä»¶ç»§æ‰¿

ğŸ‘‰ Hooks

ğŸ‘‰ HOCé«˜é˜¶ç»„ä»¶