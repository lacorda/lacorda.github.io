---
description: hooksç¯‡
slug: /0a22df3
tags: 
  - hooksç¯‡
---

# hooksç¯‡

## Reactå†…ç½®Hooks

### å¤„ç†çŠ¶æ€

1. `useState`: ç”¨äºåœ¨ç»„ä»¶ä¸­ ***æ·»åŠ çŠ¶æ€***ã€‚å®ƒè¿”å› ***ä¸€ä¸ªçŠ¶æ€å€¼*** å’Œ ***ä¸€ä¸ªæ›´æ–°çŠ¶æ€çš„å‡½æ•°***ã€‚
2. `useReducer`: ç±»ä¼¼äº `useState`ï¼Œä½†æ˜¯é€‚ç”¨äºæ›´ ***å¤æ‚çš„çŠ¶æ€é€»è¾‘***ã€‚å®ƒæ¥å—ä¸€ä¸ª reducer å‡½æ•°ï¼Œç”¨äºæ›´æ–°çŠ¶æ€ã€‚

:::tip useState ä¸ useReducer çš„åŒºåˆ«

1. ä½¿ç”¨åœºæ™¯
   - `useState`: ç®€å•çš„çŠ¶æ€ç®¡ç†ï¼Œä¾‹å¦‚: å•ä¸ªå€¼æˆ–å¯¹è±¡çš„çŠ¶æ€
   - `useReducer`: å¤æ‚çš„çŠ¶æ€é€»è¾‘ï¼Œä¾‹å¦‚: å½“çŠ¶æ€ä¹‹é—´æœ‰å¤šä¸ªç›¸å…³æ“ä½œæ—¶ï¼Œéœ€è¦å°†çŠ¶æ€å’ŒçŠ¶æ€æ›´æ–°é€»è¾‘åˆ†ç¦»ï¼Œä½¿ä»£ç æ›´æ¨¡å—åŒ–å’Œæ˜“äºç»´æŠ¤
2. ä½¿ç”¨æ–¹æ³•
   - `useState`: è¿”å›ä¸€ä¸ªçŠ¶æ€å€¼å’Œä¸€ä¸ªæ›´æ–°çŠ¶æ€çš„å‡½æ•°
   - `useReducer`: è¿”å›å½“å‰çŠ¶æ€å’Œä¸€ä¸ª dispatch å‡½æ•°ï¼Œdispatch å‡½æ•°ç”¨äºè§¦å‘çŠ¶æ€æ›´æ–°ã€‚ä½ éœ€è¦ä¼ é€’ä¸€ä¸ª action å¯¹è±¡ï¼Œæ ¹æ® action ç±»å‹æ¥æ›´æ–°çŠ¶æ€ã€‚
3. çŠ¶æ€æ›´æ–°æ–¹å¼
   - `useState`: ç›´æ¥æ›¿æ¢ç°æœ‰çŠ¶æ€
   - `useReducer`: é€šè¿‡ä½¿ç”¨ reducer å‡½æ•°æ¥ç®¡ç†çŠ¶æ€æ›´æ–°
:::

```jsx  title=useState
import React, { useState } from 'react';

function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
    </div>
  );
}
```

```jsx title=useReducer
import React, { useReducer } from 'react';

function countReducer(state, action) {
  switch (action.type) {
    case 'INCREMENT':
      return state + 1;
    default:
      return state;
  }
}

function Counter() {
  const [count, dispatch] = useReducer(countReducer, 0);

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => dispatch({ type: 'INCREMENT' })}>Increment</button>
    </div>
  );
}
```

```jsx title=useStateå®ç°useReducerçš„æ•ˆæœ
import React, { useState } from 'react';

function Counter() {
  const [count, setCount] = useState(0);

  const dispatch = (action) => {
    switch (action.type) {
      case 'INCREMENT':
        setCount(count + 1);
        break;
      default:
        break;
    }
  };

  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => dispatch({ type: 'INCREMENT' })}>Increment</button>
    </div>
  );
}

export default Counter;

```

### å¤„ç†å‰¯ä½œç”¨

1. `useEffect`: ç”¨äº ***å¤„ç†å‰¯ä½œç”¨***ï¼Œå¦‚æ•°æ®è·å–ã€è®¢é˜…ã€DOM æ“ä½œç­‰ã€‚åœ¨ç»„ä»¶ ***æ¸²æŸ“å***æ‰§è¡Œï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç»„ä»¶ ***å¸è½½æ—¶*** æ‰§è¡Œæ¸…ç†æ“ä½œã€‚
2. `useLayoutEffect`: ç±»ä¼¼äº `useEffect`ï¼Œä½†åœ¨æµè§ˆå™¨ ***ç»˜åˆ¶ä¹‹å‰åŒæ­¥æ‰§è¡Œ***ï¼Œå¯ç”¨äºè¿›è¡Œ DOM æ“ä½œå’Œæµ‹é‡å¸ƒå±€ã€‚

:::tip useEffect ä¸ useLayoutEffect çš„åŒºåˆ«

1. æ‰§è¡Œæ—¶æœº
   - `useEffect`: æµè§ˆå™¨æ¸²æŸ“å®Œæˆåå¼‚æ­¥æ‰§è¡Œï¼Œä¸ä¼šé˜»å¡é¡µé¢çš„ç»˜åˆ¶å’Œäº¤äº’
   - `useLayoutEffect`: æµè§ˆå™¨ç»˜åˆ¶ä¹‹å‰åŒæ­¥æ‰§è¡Œã€‚å¯èƒ½ä¼šå¯¼è‡´é¡µé¢é˜»å¡
2. æ€§èƒ½å½±å“
   - `useLayoutEffect`: åœ¨å¤§é‡ç»„ä»¶ä¸­å¹¿æ³›ä½¿ç”¨ï¼Œå¯èƒ½ä¼šå½±å“é¡µé¢æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒï¼Œå› ä¸ºå®ƒä¼šé˜»å¡é¡µé¢ç»˜åˆ¶

å°½å¯èƒ½ä½¿ç”¨`useEffect`ï¼Œé™¤éæ˜¯ ***ä¿®æ”¹DOMå¹¶ä¸”ä¸è®©ç”¨æˆ·çœ‹åˆ°ä¿®æ”¹DOMçš„è¿‡ç¨‹***ï¼Œæ‰è€ƒè™‘ä½¿ç”¨`useLayoutEffect`

[Demo](/site#/react-hooks/useEffect)
:::

### æ€§èƒ½ä¼˜åŒ–

1. `useCallback`: ç”¨äº ***ä¼˜åŒ–æ€§èƒ½***ï¼Œ***è®°å¿†å‡½æ•°å®ä¾‹***ï¼Œä»…åœ¨ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°åˆ›å»ºå‡½æ•°ã€‚
2. `useMemo`: ç”¨äºåœ¨ç»„ä»¶ ***æ¸²æŸ“æœŸé—´ç¼“å­˜è®¡ç®—ç»“æœ***ï¼Œä»¥ ***é¿å…é‡å¤è®¡ç®—***ï¼Œé€‚ç”¨äºè®¡ç®—æ˜‚è´µçš„å€¼ã€‚

:::tip useCallBackä½¿ç”¨åœºæ™¯

1. ä½¿ç”¨ï¼š
   - æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè¦è¿›è¡Œä¼˜åŒ–çš„å‡½æ•° å’Œ ä¸€ä¸ªä¾èµ–æ•°ç»„ï¼Œåªæœ‰æ•°ç»„ä¸­çš„ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°åˆ›å»ºå‡½æ•°ã€‚
     - ***ä¼˜åŒ–çš„å‡½æ•°å¯ä»¥æ¥æ”¶ä»»ä½•æ•°é‡çš„å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°ç”±è¿”å›å‡½æ•°çš„å‚æ•°***
   - è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªè®°å¿†åŒ–çš„å‡½æ•°å®ä¾‹ï¼Œè¯¥å‡½æ•°åªåœ¨ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶æ‰é‡æ–°åˆ›å»º
2. åœºæ™¯ï¼š
   - çˆ¶ç»„ä»¶å°†ä¸€ä¸ª`å‡½æ•°`ä½œä¸º `prop` ä¼ é€’ç»™å­ç»„ä»¶æ—¶ã€‚ä½¿ç”¨ `useCallback` å¯ä»¥ ***ç¡®ä¿æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¸ä¼šåˆ›å»ºæ–°çš„å‡½æ•°å®ä¾‹ï¼Œä»è€Œå‡å°‘ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“***ã€‚

[Demo](/site#/react-hooks/useCallback)
:::

:::tip useMemoä½¿ç”¨åœºæ™¯

1. ä½¿ç”¨ï¼š
   - æ¥å—ä¸¤ä¸ªå‚æ•°ï¼šè®¡ç®—å‡½æ•° å’Œ ä¸€ä¸ªä¾èµ–æ•°ç»„ï¼Œåªæœ‰æ•°ç»„ä¸­çš„ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰ä¼šé‡æ–°è®¡ç®—
   - è¿”å›å€¼ï¼šè¿”å›ä¸€ä¸ªè®°å¿†åŒ–çš„å€¼ã€‚
2. åœºæ™¯ï¼š
   - é¿å…ä¸å¿…è¦çš„é‡å¤æ¸²æŸ“
   - é¿å…æ¥å£é‡å¤è¯·æ±‚
   - è¿”å›å‡½æ•°æ—¶å¯ä»¥åƒ`useCallBack`ä¸€æ ·ä½¿ç”¨
:::

```jsx title=useCallBack
// Buttonç»„ä»¶
import React from 'react';

const Button = ({ onClick, label }) => {
  console.log('Button rendered:', label);
  return <button onClick={onClick}>{label}</button>;
};

export default React.memo(Button);

// çˆ¶ç»„ä»¶
import React, { useState, useCallback } from 'react';
import Button from './button';
import Container from '../../../_components/container';

const UseCallbackDemo = (props) => {
  const [count1, setCount1] = useState(0);
  const [count2, setCount2] = useState(0);

  // ä½¿ç”¨ useCallback ä¼˜åŒ–å›è°ƒå‡½æ•°çš„åˆ›å»º
  const handleIncrement1 = useCallback(() => {
    setCount1(count1 + 1);
  }, [count1]);

  const handleIncrement2 = useCallback(() => {
    setCount2(count2 + 1);
  }, [count2]);

  // const handleIncrement1 = () => {
  //   setCount1(count1 + 1);
  // };

  // const handleIncrement2 = () => {
  //   setCount2(count2 + 1);
  // };

  return (
    <Container {...props} className="usecallback-container">
      <Button onClick={handleIncrement1} label={`Count 1: ${count1}`} />
      <Button onClick={handleIncrement2} label={`Count 2: ${count2}`} />
    </Container>
  );
};

export default UseCallbackDemo;
```

```jsx title=useMemo
import React, { useState, useMemo } from 'react';

const NumberList = ({ numbers }) => {
  return (
    <ul>
      {numbers.map((number) => (
        <li key={number}>Square of {number}: {number * number}</li>
      ))}
    </ul>
  );
};

const UseMemoDemo = (props) => {
  const [numbers, setNumbers] = useState([1, 2, 3, 4, 5]);
  const [count, setCount] = useState(0);

  // ä½¿ç”¨ useMemo ä¼˜åŒ–è®¡ç®—å¹³æ–¹
  const squaredNumbers = useMemo(() => {
    console.log('ğŸ‰  squaredNumbers é‡æ–°è®¡ç®— ');
    return numbers.map((number) => number * number);
  }, [numbers]);

  return (
    <Container {...props} className="usecallback-container">
      <h1>Number Squares</h1>
      <NumberList numbers={squaredNumbers} />
      <Button type="primary" size="sm" onClick={() => setCount(count + 1)}>count: {count}</Button>
      <br />
      <br />
      <Button type="primary" size="sm" onClick={() => setNumbers(numbers.map(n => n + 1))}>numbers: {numbers}</Button>
    </Container >
  );
};

export default UseMemoDemo;

```

### ç»„ä»¶ä¸Šä¸‹æ–‡

1. `useContext`: ç”¨äºè®¿é—® ***React ä¸Šä¸‹æ–‡***ã€‚å…è®¸ä½ åœ¨ç»„ä»¶ä¸­è®¢é˜…ä¸Šä¸‹æ–‡çš„å˜åŒ–ã€‚

```jsx title=MyContext åˆ›å»ºä¸€ä¸ªcontext
import React, { createContext } from 'react';

// åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡
const MyContext = createContext();

export default MyContext;

```

```jsx title=çˆ¶ç»„ä»¶ Provideræ³¨å†Œcontext value
import React from 'react';
import MyContext from './MyContext';

const ParentComponent = () => {
  const sharedData = "This is shared data";

  return (
    <MyContext.Provider value={sharedData}>
      {/* åœ¨è¿™é‡Œçš„å­ç»„ä»¶å¯ä»¥è®¿é—®åˆ°å…±äº«çš„æ•°æ® */}
      <ChildComponent />
    </MyContext.Provider>
  );
};

export default ParentComponent;
```

```jsx title=å­ç»„ä»¶ useContextè·å–content value
import React, { useContext } from 'react';
import MyContext from './MyContext';

const ChildComponent = () => {
  // ä½¿ç”¨ useContext æ¥è·å–ä¸Šä¸‹æ–‡æ•°æ®
  const sharedData = useContext(MyContext);

  return <div>{sharedData}</div>;
};

export default ChildComponent;

```

### ä¿å­˜å€¼/æ€§èƒ½ä¼˜åŒ–

1. `useRef`: è¿”å›ä¸€ä¸ªå¯å˜çš„ ***ref å¯¹è±¡***ï¼Œå¯ä»¥ç”¨äº ***ä¿å­˜ç»„ä»¶å†…çš„å€¼***ï¼Œè€Œ ***ä¸ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“***ã€‚

### æš´éœ²å®ä¾‹å±æ€§ä¸æ–¹æ³•

1. `useImperativeHandle`: ç”¨äºè‡ªå®šä¹‰ç»„ä»¶æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ï¼Œé€šå¸¸ä¸ `forwardRef` ä¸€èµ·ä½¿ç”¨ã€‚

```jsx  title=å­ç»„ä»¶
import React, { forwardRef, useImperativeHandle, useState } from 'react';

const ChildComponent = forwardRef((props, ref) => {
  const [count, setCount] = useState(0);

  // åœ¨å­ç»„ä»¶å†…å®šä¹‰ä¸€ä¸ªæš´éœ²ç»™çˆ¶ç»„ä»¶çš„æ–¹æ³•
  const increment = () => {
    setCount(count + 1);
  };

  // ä½¿ç”¨ useImperativeHandle æš´éœ²æ–¹æ³•å’Œå±æ€§ç»™çˆ¶ç»„ä»¶
  useImperativeHandle(ref, () => ({
    increment, // æš´éœ²çš„æ–¹æ³•
    count     // æš´éœ²çš„å±æ€§
  }));

  return <div>Count: {count}</div>;
});

export default ChildComponent;
```

```jsx title=çˆ¶ç»„ä»¶
import React, { useRef } from 'react';
import ChildComponent from './ChildComponent';

function ParentComponent() {
  const childRef = useRef();

  const handleButtonClick = () => {
    // è°ƒç”¨å­ç»„ä»¶çš„æ–¹æ³•
    childRef.current.increment();
  };

  return (
    <div>
      <ChildComponent ref={childRef} />
      <button onClick={handleButtonClick}>Increment Child Count</button>
    </div>
  );
}

export default ParentComponent;
```

## React-Routerå†…ç½®Hooks

### useHistory

```jsx
import { useHistory } from 'react-router-dom';

function MyComponent() {
  const history = useHistory();

  const handleClick = () => {
    // åœ¨ç‚¹å‡»æ—¶å¯¼èˆªåˆ°å¦ä¸€ä¸ªè·¯ç”±
    history.push('/another-route');
  };

  return (
    <div>
      <button onClick={handleClick}>Go to Another Route</button>
    </div>
  );
}
```

### useLocation

```jsx
import { useLocation } from 'react-router-dom';

function MyComponent() {
  const location = useLocation();

  return (
    <div>
      <p>Current Path: {location.pathname}</p>
    </div>
  );
}
```

### useParams

```jsx
import { useParams } from 'react-router-dom';

function UserProfile() {
  const { username } = useParams();

  return (
    <div>
      <p>Username: {username}</p>
    </div>
  );
}
```

### useRouteMatch æ˜¯å¦è·¯ç”±åŒ¹é…

```jsx
import { useRouteMatch } from 'react-router-dom';

function MyComponent() {
  const match = useRouteMatch('/some-route');

  return (
    <div>
      {match ? <p>Matched!</p> : <p>Not Matched</p>}
    </div>
  );
}
```

## è‡ªå®šä¹‰Hooks - ahooks

[ahooksåˆ—è¡¨](https://ahooks.js.org/zh-CN/)
