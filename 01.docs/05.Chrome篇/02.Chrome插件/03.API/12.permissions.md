
# permissions æƒé™
[å®˜æ–¹æ–‡æ¡£](https://developer.chrome.com/docs/extensions/reference/permissions)

> é’ˆå¯¹å£°æ˜çš„å¯é€‰æƒé™(`optional_permissions`)ï¼› â€”â€”â€”â€” è¯·æ±‚æˆäºˆæ‰©å±•ç¨‹åºæŸäº›æƒé™(`request`)
> é’ˆå¯¹å·²æˆäºˆçš„æƒé™(`permissions`):
> 1. æŸ¥è¯¢å½“å‰æ‰©å±•ç¨‹åºæ˜¯å¦å…·æœ‰æŸäº›æƒé™(`contains`)
> 2. ç§»é™¤å·²æˆäºˆçš„æƒé™(`remove`)ï¼›ç§»é™¤æ‰€æœ‰å·²æˆäºˆçš„æƒé™(`removeAll`)ï¼›
> 3. ç›‘å¬æƒé™å˜æ›´(`onAdded`ã€`onRemoved`)

## æ–¹æ³•

### contains() æŸ¥è¯¢æƒé™
> æŸ¥è¯¢å½“å‰æ‰©å±•ç¨‹åºæ˜¯å¦å…·æœ‰æŸäº›æƒé™

```ts
type Permissions = {
  permissions: string[];
  origins?: string[];
}
chrome.permissions.contains(
  permissions: Permissions,
  callback?: function,
)
```

### request() è¯·æ±‚æƒé™
> è¯·æ±‚æˆäºˆæ‰©å±•ç¨‹åºæŸäº›æƒé™ï¼Œéœ€è¦åœ¨`manifest.json`ä¸­å£°æ˜`optional_permissions`

```json
{
  "optional_permissions": [
    // ...
  ]
}
```

```ts
type Permissions = {
  permissions: string[];
  origins?: string[];
}
chrome.permissions.request(
  permissions: Permissions,
  callback?: function,
)
```

### remove() ç§»é™¤æƒé™
> ç§»é™¤å·²æˆäºˆçš„æƒé™

```ts
type Permissions = {
  permissions: string[];
  origins?: string[];
}
chrome.permissions.remove(
  permissions: Permissions,
  callback?: function,
)
```

### removeAll() ç§»é™¤æ‰€æœ‰æƒé™
> ç§»é™¤æ‰€æœ‰å·²æˆäºˆçš„æƒé™

```ts
chrome.permissions.removeAll(
  callback?: function,
)
```

### getAll() è·å–æ‰€æœ‰æƒé™
> è·å–æ‰€æœ‰å·²æˆäºˆçš„æƒé™

```ts
chrome.permissions.getAll(
  callback?: function,
)
```


## äº‹ä»¶

### onAdded æ·»åŠ äº‹ä»¶
> å½“æƒé™è¢«æ·»åŠ æ—¶è§¦å‘

```js
// background.js
chrome.permissions.onAdded.addListener((permissions) => {
  console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> ç›‘å¬æ·»åŠ äº‹ä»¶', Date.now(), permissions);
});
```

### onRemoved ç§»é™¤äº‹ä»¶
> å½“æƒé™è¢«ç§»é™¤æ—¶è§¦å‘

```js
// background.js
chrome.permissions.onRemoved.addListener((permissions) => {
  console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> ç›‘å¬ç§»é™¤äº‹ä»¶', Date.now(), permissions);
});
```

