---
description: alarms
slug: /53f6596
tags: 
  - alarms
---

# alarms é—¹é’Ÿ
> å®‰æ’ä»£ç å‘¨æœŸæ€§åœ°æˆ–è€…åœ¨å°†æ¥çš„æŒ‡å®šæ—¶é—´è¿è¡Œ

## æƒé™è®¾ç½®

```json
"permissions": [
  "alarms"
],
```

## æ–¹æ³•
### åˆ›å»ºé—¹é’Ÿ
> åˆ›å»ºé—¹é’Ÿï¼Œå¦‚æœå·²å­˜åœ¨ï¼Œåˆ™ä¼šæ›´æ–°
> å‡å°‘ç”¨æˆ·è®¡ç®—æœºä¸Šçš„è´Ÿè½½ï¼ŒChrome å°†è­¦æŠ¥é™åˆ¶ä¸ºæœ€å¤šæ¯ 30 ç§’ä¸€æ¬¡

```ts
// é—¹é’Ÿåå­—
type alarmName = string;

// é—¹é’Ÿä¿¡æ¯
// é—¹é’Ÿè§¦å‘æ—¶é—´: {when}msæ—¶è§¦å‘   /  {delayInMinutes}åˆ†é’Ÿåè§¦å‘
// é—¹é’Ÿå‘¨æœŸ: æ¯{periodInMinutes}åˆ†é’Ÿè§¦å‘ä¸€æ¬¡
type alarmInfo = {
  // é—¹é’Ÿè§¦å‘æ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’
  when: number;
  // xåˆ†é’Ÿåè§¦å‘ï¼Œå•ä½ï¼šåˆ†é’Ÿ
  delayInMinutes: number;
  // é—¹é’Ÿæ¯xåˆ†é’Ÿè§¦å‘ä¸€æ¬¡ï¼ˆwhen/delayInMinutesåˆå§‹äº‹ä»¶ä¹‹åå¼€å§‹ç®—ï¼‰
  periodInMinutes: number;
}

chrome.alarms.create(alarmName, alarmInfo);
```

```js
// background.js
chrome.runtime.onInstalled.addListener(async ({ reason }) => {
  if (reason !== 'install') {
    return;
  }

  // Create an alarm so we have something to look at in the demo
  await chrome.alarms.create(MY_ALARM, {
    // é—¹é’Ÿå‘¨æœŸï¼Œå•ä½ï¼šåˆ†é’Ÿ
    periodInMinutes: 1,
    // é—¹é’Ÿè§¦å‘æ—¶é—´ï¼Œå•ä½ï¼šæ¯«ç§’
    when: Date.now() + 1000 * 60 * 1,
  });
});
```


### clear()æ–¹æ³•
> æ¸…é™¤é—¹é’Ÿ

```js
// background.js
chrome.alarms.clear(MY_ALARM, (wasCleared) => {
  console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> æ¸…é™¤é—¹é’Ÿ', Date.now(), wasCleared);
});

// æ¸…é™¤æ‰€æœ‰é—¹é’Ÿ
chrome.alarms.clearAll((wasCleared) => {
  console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> æ¸…é™¤æ‰€æœ‰é—¹é’Ÿ', Date.now(), wasCleared);
});
```

### get()æ–¹æ³•
> è·å–é—¹é’Ÿ

```js
// background.js
chrome.alarms.get(MY_ALARM, (alarm) => {
  console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> è·å–é—¹é’Ÿ', Date.now(), alarm);
});

// è·å–æ‰€æœ‰é—¹é’Ÿ
chrome.alarms.getAll((alarms) => {
  console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> è·å–æ‰€æœ‰é—¹é’Ÿ', Date.now(), alarms);
});
```


## äº‹ä»¶
###  onAlarmäº‹ä»¶
> ç›‘å¬é—¹é’Ÿè§¦å‘äº‹ä»¶

```js
// background.js
chrome.alarms.onAlarm.addListener((alarm) => {
  if (alarm.name === MY_ALARM) {
    console.log('ğŸ„  background: >>>>>>>>>>>>>>>>>> ç›‘å¬é—¹é’Ÿè§¦å‘äº‹ä»¶', Date.now(), alarm);
  }
});
```


## ç¤ºä¾‹

#### æ£€æµ‹é—¹é’Ÿçš„æŒç»­æ€§
> é—¹é’Ÿåœ¨æµè§ˆå™¨å…³é—­åä¼šè¢«æ¸…é™¤ï¼Œå¦‚æœéœ€è¦æŒç»­æ€§ï¼Œéœ€è¦åœ¨`background.js`ä¸­é‡æ–°æ³¨å†Œ

```js
// background.js
const STORAGE_KEY = "ALARM_ENABLED";
const MY_ALARM = "my-alarm";

async function checkAlarmState() {
  // åˆ¤æ–­ä¸Šæ¬¡å…³é—­æµè§ˆå™¨æ—¶ï¼Œé—¹é’Ÿæ˜¯å¦å¼€å¯
  const { alarmEnabled } = await chrome.storage.get(STORAGE_KEY);

  if (alarmEnabled) {
    const alarm = await chrome.alarms.get(MY_ALARM);

    if (!alarm) {
      await chrome.alarms.create({ periodInMinutes: 1 });
    }
  }
}

checkAlarmState();
```
